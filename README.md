# 视频帧高度修改工具

一个简洁易用的视频分辨率调整工具，支持GPU加速，自动检测视频分辨率并转换为标准格式。

## 功能特点

✨ **智能检测** : 自动识别视频分辨率并应用对应的转换规则  
🚀 **GPU加速**：支持NVIDIA、AMD、Intel GPU硬件加速  
🎯 **精准转换**: 针对特定分辨率进行优化转换  
📊 **实时日志**：可复制的详细转换日志和进度显示  
🖥️ **简洁UI**：现代化的图形用户界面  

## 转换规则

| 检测分辨率 | 目标分辨率 | 说明 |
|-----------|-----------|------|
| 宽度 3840 | 3840 x 2160 | 4K标准分辨率 |
| 宽度 5120 | 5120 x 2880 | 5K标准分辨率 |
| 宽度 7680 | 7680 x 4320 | 8K标准分辨率 |
| 其他分辨率 | 跳过处理 | 不支持的分辨率会被跳过 |

## 系统要求

- **操作系统**: Windows 10/11
- **Python**：3.7 或更高版本
- **内存**：建议 4GB 以上
- **存储**：转换时需要足够的磁盘空间
- **GPU**：可选，支持硬件加速
<img width="794" height="723" alt="捕获" src="https://github.com/user-attachments/assets/4246c75a-6a4f-474b-a49b-c7c92d8410cc" />
##快速开始

### 1. 检查Python环境

```bash
python --版本
```

### 2. 运行程序

```bash
python main.py
```

### 3. 使用步骤

1. **选择文件**: 点击“选择视频文件”按钮，选择需要转换的视频
2. **配置设置**：
   -☑️ 启用GPU加速（推荐）
   - ☐ 覆盖原文件（可选，默认生成新文件）
3. **开始转换**：点击"开始转换"按钮
4. **查看进度**：在日志区域查看详细的转换进度
5. **复制日志**: 转换完成后可复制日志用于备份

## 支持的视频格式

**输入格式**: MP4, AVI, MKV, MOV, WMV, FLV, WebM, M4V, 3GP  
**输出格式**: MP4 (H.264编码)

## GPU加速支持

工具会自动检测并使用可用的GPU加速选项：

- 🟢 **NVIDIA GPU**：使用 NVENC 硬件编码器
- 🟡 **AMD GPU** **: 使用 AMF 硬件编码器**
- 🔵 **Intel GPU**: 使用 QuickSync 硬件编码器
- ⚪ **CPU编码**: 无GPU时自动回退到CPU编码

### 高分辨率GPU支持

针对 **5K (5120x2880)** 和 **8K (7680x4320)** 等高分辨率，程序会：

1. **自动检测GPU限制**：检查GPU是否支持目标分辨率
2. **优化编码参数**：为高分辨率使用更保守的设置
3. **智能回退**：GPU不支持时自动切换到CPU编码
4. **提高码率**：为高分辨率设置更高的码率和缓冲区

**GPU分辨率限制**：
- **NVIDIA NVENC**: 最大 4096x4096（较新显卡可能支持更高）
- **AMD AMF**: 最大 4096x2304
- **Intel QuickSync**: 最大 4096x4096

如果您的GPU不支持高分辨率，程序会自动使用CPU编码，虽然速度较慢但能保证转换成功。

## 文件输出

### 默认模式
转换后的文件会保存在原视频同目录下，文件名添加 `_resized` 后缀：
```
原文件: video.mp4
新文件: video_resized.mp4
```

### 覆盖模式
勾选"覆盖原文件"选项时，会直接替换原文件。

## 项目结构

```
ffmpeg8.0/
├── bin/                  # FFmpeg可执行文件
│   ├── ffmpeg.exe       # 视频转换工具
│   └── ffprobe.exe      # 视频信息检测工具
├── doc/                 # FFmpeg文档
├── main.py             # 主程序入口
├── video_processor.py  # 视频处理核心模块
├── requirements.txt    # 依赖说明
└── README.md          # 项目说明
```

## 核心模块说明

### main.py
- 图形用户界面
- 文件选择和管理
- 进度显示和日志
- 用户交互控制

### video_processor.py
- FFmpeg命令构建
- GPU加速检测
- 视频信息获取
- 转换进程管理

## 常见问题

### Q: 转换速度慢怎么办？
A: 
1. 确保启用了GPU加速
2. 检查系统资源使用情况
3. 关闭其他占用GPU的程序

### Q: 不支持的分辨率如何处理？
A: 
目前支持 3840、5120 和 7680 宽度的视频转换，其他分辨率会被自动跳过。

### Q: 转换失败怎么办？
A: 
1. 查看日志区域的错误信息
2. 确保视频文件完整且未损坏
3. 检查磁盘空间是否充足
4. 复制日志信息寻求帮助

### Q: 如何查看详细的FFmpeg命令？
A: 
在日志区域会显示完整的FFmpeg执行命令，可以复制用于调试。

## 技术细节

### GPU检测机制
程序会自动检测系统中可用的硬件编码器：
- 执行 `ffmpeg -encoders` 命令
- 查找支持的硬件编码器
- 按优先级选择最佳编码器

### 质量设置
- **NVIDIA**: CQ=23 (恒定质量)
- **AMD**: QP=23 (量化参数)
- **Intel**: Global Quality=23
- **CPU**: CRF=23 (恒定码率因子)

### 音频处理
音频流采用直接复制模式，不进行重新编码，保证：
- 🎵 原始音质不损失
- ⚡ 更快的处理速度
- 🔄 完美的音视频同步

## 开发信息

- **开发语言**: Python 3.7+
- **GUI框架**: tkinter (Python标准库)
- **视频处理**: FFmpeg 8.0
- **多线程**: 支持后台转换，界面不冻结
- **跨平台**: 设计为Windows优先，可扩展到其他平台

## 许可证

本项目基于FFmpeg，遵循相应的开源许可证。

## 更新日志

### v1.0.0 (2024-10-02)
- ✨ 初始版本发布
- 🎯 支持3840x2160、5120x2880和7680x4320分辨率转换
- 🚀 GPU硬件加速支持
- 📊 实时进度显示和日志
- 🖥️ 现代化GUI界面

---

**提示**: 如遇到问题，请查看日志区域的详细信息，或复制日志内容寻求帮助.
